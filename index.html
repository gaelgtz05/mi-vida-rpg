<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Vida RPG</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --bg-color: #0d1117; /* Negro azulado oscuro */
            --main-color: #161b22; /* Un poco más claro para los contenedores */
            --border-color: #30363d; /* Bordes sutiles */
            --text-color: #c9d1d9; /* Blanco suave */
            --text-accent-color: #f0f6fc; /* Blanco más brillante para títulos */
            --accent-color: #388bfd; /* Azul neón brillante */
            --xp-color: #388bfd;
            --success-color: #238636;
            --danger-color: #da3633;
        }
        body { font-family: 'Press Start 2P', cursive; background-color: var(--bg-color); color: var(--text-color); text-shadow: 2px 2px #00000060; image-rendering: pixelated; }
        .pixel-box { background-color: var(--main-color); border: 4px solid var(--border-color); box-shadow: 6px 6px 0px #000000; padding: 1.5rem; }
        .pixel-button { background-color: var(--accent-color); border: 4px solid var(--border-color); box-shadow: 4px 4px 0px #000000; padding: 0.75rem 1rem; color: var(--text-accent-color); text-transform: uppercase; cursor: pointer; transition: transform 0.1s, box-shadow 0.1s; }
        .pixel-button:hover { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #000000; }
        .pixel-button.green { background-color: var(--success-color); } .pixel-button.red { background-color: var(--danger-color); }
        .pixel-button.yellow { background-color: var(--accent-color); } .pixel-button.gray { background-color: #484f58; }
        input, textarea { font-family: 'Press Start 2P', cursive; background-color: var(--bg-color); border: 4px solid var(--border-color); padding: 0.75rem; color: var(--text-color); width: 100%; }
        input:focus, textarea:focus { outline: none; border-color: var(--accent-color); }
        .progress-bar-container { background-color: var(--bg-color); border: 2px solid var(--border-color); padding: 4px; }
        .progress-bar { height: 20px; }
        .modal-backdrop { background-color: rgba(0,0,0,0.8); transition: opacity 0.2s; }
        .tab-button { background-color: #484f58; flex-grow: 1; }
        .tab-button.active { background-color: var(--accent-color); transform: none; box-shadow: 4px 4px 0px #000000 inset; }
        .tab-content { display: none; } .tab-content.active { display: block; }
        ::-webkit-scrollbar { width: 16px; } ::-webkit-scrollbar-track { background: var(--bg-color); border-left: 4px solid var(--border-color); }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border: 4px solid var(--main-color); }
        .pixel-checkbox { appearance: none; width: 24px; height: 24px; background-color: var(--bg-color); border: 3px solid var(--border-color); cursor: pointer; position: relative; margin-right: 0.75rem; flex-shrink: 0; }
        .pixel-checkbox:checked { background-color: var(--accent-color); border-color: var(--text-accent-color); }
        .pixel-checkbox:checked::after { content: 'X'; color: var(--text-accent-color); position: absolute; font-size: 14px; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        
        /* --- ESTILOS DE CARRUSEL --- */
        .carousel-wrapper { position: relative; }
        .carousel-container { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; scrollbar-width: none; /* Firefox */ -webkit-overflow-scrolling: touch; /* iOS */ }
        .carousel-container::-webkit-scrollbar { display: none; /* Safari & Chrome */ }
        .carousel-slide { flex: 0 0 80%; scroll-snap-align: center; margin: 0 10px; padding-bottom: 2rem; } /* Más padding para el nombre y el precio */
        @media (min-width: 768px) { .carousel-slide { flex-basis: 40%; } }
        @media (min-width: 1024px) { .carousel-slide { flex-basis: 30%; } }
        .carousel-nav { display: none; position: absolute; top: 50%; transform: translateY(-50%); width: 100%; justify-content: space-between; pointer-events: none; }
        @media (min-width: 768px) { .carousel-nav { display: flex; } }
        .nav-arrow { pointer-events: all; background-color: rgba(22, 27, 34, 0.7); border: 2px solid var(--border-color); border-radius: 50%; padding: 0.5rem; }
        
        /* --- IMÁGENES DE ITEMS (TIENDA E INVENTARIO) SIN RECUADRO --- */
        .item-image {
            width: 100%;
            height: 180px; /* Altura generosa para el objeto */
            object-fit: contain; /* Ajusta la imagen dentro del espacio sin recortar */
            background-color: transparent; /* Fondo transparente */
            border: none; /* Sin borde */
            transition: filter 0.3s ease-in-out;
        }
        .item-image.locked { filter: grayscale(1) opacity(0.5); }
        .lock-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; color: var(--text-accent-color); text-shadow: 3px 3px 0px #000; pointer-events: none; }
        
        input[type="file"] { border: none; padding: 0; }
        input[type="file"]::file-selector-button { font-family: 'Press Start 2P'; background-color: var(--accent-color); border: 2px solid var(--border-color); padding: 0.5rem; color: var(--text-accent-color); cursor: pointer; }

        /* Contenedores de items más limpios */
        .item-card-minimal {
            background-color: transparent; /* El fondo lo da el carrusel o el inventario */
            border: none; /* Sin borde exterior */
            box-shadow: none; /* Sin sombra exterior */
            padding: 0.5rem; /* Pequeño padding interno si es necesario */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative; /* Para el overlay del candado */
        }
        .item-card-minimal .item-name { margin-top: 0.5rem; font-size: 0.9rem; }
        .item-card-minimal .item-price { font-size: 0.8rem; }

    </style>
</head>
<body class="p-4 md:p-8">

    <div class="container mx-auto max-w-5xl">

        <header class="pixel-box mb-8">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="text-center md:text-left"><h1 class="text-2xl md:text-3xl text-text-accent-color">MI VIDA RPG</h1></div>
                <div class="w-full md:w-2/3 space-y-3">
                    <div class="flex items-center gap-2 text-sm"><span class="text-blue-400">PROGRESO:</span><div class="progress-bar-container w-full"><div id="xp-bar" class="progress-bar bg-blue-500" style="width: 0%;"></div></div><span id="xp-text">0%</span></div>
                    <div class="flex items-center gap-2 text-sm"><span class="text-green-400">SALDO:</span><div id="player-balance" class="text-green-400 font-bold">$0.00</div></div>
                </div>
            </div>
        </header>

        <nav class="flex flex-wrap gap-2 mb-4">
            <button class="tab-button pixel-button active" onclick="showTab('misiones')">Misiones</button>
            <button class="tab-button pixel-button" onclick="showTab('finanzas')">Finanzas</button>
            <button class="tab-button pixel-button" onclick="showTab('tienda')">Tienda</button>
            <button class="tab-button pixel-button" onclick="showTab('inventario')">Inventario</button>
            <button class="tab-button pixel-button" onclick="showTab('armario')">Armario</button>
        </nav>

        <main>
            <div id="misiones-tab" class="tab-content active">
                <div class="pixel-box"><h2 class="text-xl mb-4 text-center text-text-accent-color">MISIONES DIARIAS</h2><div id="mission-list" class="space-y-4 mb-6 max-h-96 overflow-y-auto p-2"></div><div class="flex flex-col md:flex-row gap-4"><input type="text" id="new-mission-input" placeholder="Nueva misión..."><button class="pixel-button" onclick="addMission()">Aceptar Misión</button></div></div>
            </div>
            <div id="finanzas-tab" class="tab-content">
                 <div class="pixel-box"><h2 class="text-xl mb-4 text-center text-text-accent-color">LIBRO DE CUENTAS</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"><button class="pixel-button green" onclick="openModal('income-modal')">+ Ingreso</button><button class="pixel-button red" onclick="openModal('expense-modal')">- Egreso</button></div><h3 class="text-lg mb-2">Historial:</h3><div id="transaction-list" class="space-y-3 text-sm max-h-80 overflow-y-auto border-2 border-dashed border-gray-600 p-2"></div></div>
            </div>
            <div id="tienda-tab" class="tab-content">
                <div class="pixel-box">
                    <h2 class="text-xl mb-4 text-center text-text-accent-color">TIENDA DE DESEOS</h2>
                    <div class="carousel-wrapper">
                        <div id="store-carousel" class="carousel-container"></div>
                        <div class="carousel-nav"><button id="prev-btn" class="nav-arrow" onclick="slideStore(-1)"><i data-lucide="arrow-left"></i></button><button id="next-btn" class="nav-arrow" onclick="slideStore(1)"><i data-lucide="arrow-right"></i></button></div>
                    </div>
                    <button class="pixel-button w-full mt-6" onclick="openModal('new-item-modal')">Añadir Objeto a la Tienda</button>
                </div>
            </div>
            <div id="inventario-tab" class="tab-content">
                <div class="pixel-box">
                    <h2 class="text-xl mb-4 text-center text-text-accent-color">INVENTARIO</h2>
                    <div id="inventory-list" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 max-h-96 overflow-y-auto p-2"></div>
                </div>
            </div>
            <div id="armario-tab" class="tab-content">
                 <div class="pixel-box"><h2 class="text-xl mb-6 text-center text-text-accent-color">GUARDARROPA</h2><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-1"><h3 class="text-lg mb-4">Planificador Semanal</h3><div id="weekly-planner" class="space-y-3"></div></div><div class="lg:col-span-2"><h3 class="text-lg mb-4">Mi Inventario</h3><div id="wardrobe-inventory" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-h-[400px] overflow-y-auto border-2 border-dashed border-gray-600 p-2"></div><button class="pixel-button w-full mt-4" onclick="openModal('add-clothing-modal')">Añadir Prenda</button></div></div></div>
            </div>
        </main>
    </div>

    <div id="income-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden"><div class="pixel-box w-full max-w-md"><h3 class="text-lg mb-4">Registrar Ingreso</h3><input type="number" id="income-amount" placeholder="Monto ($)" class="mb-3"><input type="text" id="income-source" placeholder="Origen (ej. Salario)" class="mb-4"><div class="flex justify-end gap-3"><button onclick="closeModal('income-modal')" class="pixel-button gray">Cerrar</button><button onclick="addTransaction('income')" class="pixel-button green">Registrar</button></div></div></div>
    <div id="expense-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden"><div class="pixel-box w-full max-w-md"><h3 class="text-lg mb-4">Registrar Egreso</h3><input type="number" id="expense-amount" placeholder="Monto ($)" class="mb-3"><input type="text" id="expense-description" placeholder="Descripción (ej. Comida)" class="mb-4"><div class="flex justify-end gap-3"><button onclick="closeModal('expense-modal')" class="pixel-button gray">Cerrar</button><button onclick="addTransaction('expense')" class="pixel-button red">Registrar</button></div></div></div>
    <div id="new-item-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden"><div class="pixel-box w-full max-w-md"><h3 class="text-lg mb-4">Nuevo Objeto para la Tienda</h3><input type="text" id="item-name" placeholder="Nombre del objeto" class="mb-3"><input type="number" id="item-price" placeholder="Precio ($)" class="mb-3"><label class="text-sm mb-2 block">Imagen (PNG, JPG):</label><input type="file" id="item-image-upload" accept="image/png, image/jpeg" class="mb-4"><div class="flex justify-end gap-3"><button onclick="closeModal('new-item-modal')" class="pixel-button gray">Cerrar</button><button onclick="addStoreItem()" class="pixel-button">Añadir</button></div></div></div>
    <div id="add-clothing-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden"><div class="pixel-box w-full max-w-md"><h3 class="text-lg mb-4">Añadir Prenda al Armario</h3><input type="text" id="clothing-name" placeholder="Nombre de la prenda" class="mb-3"><input type="text" id="clothing-url" placeholder="URL de la imagen" class="mb-4"><div class="flex justify-end gap-3"><button onclick="closeModal('add-clothing-modal')" class="pixel-button gray">Cerrar</button><button onclick="addWardrobeItem()" class="pixel-button">Añadir</button></div></div></div>
    <div id="plan-outfit-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden"><div class="pixel-box w-full max-w-2xl"><h3 class="text-lg mb-4" id="plan-outfit-title">Planificar Outfit para...</h3><div id="plan-outfit-inventory" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-4 max-h-80 overflow-y-auto border-2 border-dashed border-gray-600 p-2 mb-4"></div><div class="flex justify-end gap-3"><button onclick="closeModal('plan-outfit-modal')" class="pixel-button gray">Cerrar</button></div></div></div>

<script>
let state = { balance: 0, missions: [], transactions: [], storeItems: [], wardrobe: { clothes: [], outfits: { Lunes: [], Martes: [], Miércoles: [], Jueves: [], Viernes: [], Sábado: [], Domingo: [] } } };
const DOM = { xpBar: document.getElementById('xp-bar'), xpText: document.getElementById('xp-text'), playerBalance: document.getElementById('player-balance'), missionList: document.getElementById('mission-list'), transactionList: document.getElementById('transaction-list'), storeCarousel: document.getElementById('store-carousel'), inventoryList: document.getElementById('inventory-list'), wardrobeInventory: document.getElementById('wardrobe-inventory'), weeklyPlanner: document.getElementById('weekly-planner') };

function saveState() { localStorage.setItem('miVidaRpgState_v5', JSON.stringify(state)); } // Actualizado a v5 para evitar conflictos con versiones anteriores
function loadState() { const s = localStorage.getItem('miVidaRpgState_v5'); if(s) state = JSON.parse(s); }

function render() {
    renderStats(); renderMissions(); renderTransactions(); renderStore(); renderInventory(); renderWardrobe(); lucide.createIcons();
}
function renderStats() { DOM.playerBalance.textContent = `$${state.balance.toFixed(2)}`; updateXpBar(); }
function updateXpBar() { const total = state.missions.length; const completed = state.missions.filter(m => m.completed).length; const perc = total === 0 ? 0 : Math.round((completed / total) * 100); DOM.xpBar.style.width = `${perc}%`; DOM.xpText.textContent = `${perc}%`; }

function renderMissions() { DOM.missionList.innerHTML = state.missions.length === 0 ? '<p class="text-center opacity-50">No hay misiones.</p>' : state.missions.map((m, i) => `<div class="p-3 border-2 ${m.completed ? 'border-gray-600 opacity-50' : 'border-gray-400'} flex items-center"><input type="checkbox" id="mission-${i}" class="pixel-checkbox" onchange="toggleMission(${i})" ${m.completed ? 'checked' : ''}><label for="mission-${i}" class="${m.completed ? 'line-through' : ''}">${m.text}</label></div>`).join(''); }
function renderTransactions() { DOM.transactionList.innerHTML = state.transactions.length === 0 ? '<p class="text-center opacity-50">Sin transacciones.</p>' : [...state.transactions].reverse().map(tx => `<div class="p-2 border-b-2 border-dashed border-gray-700"><div class="flex justify-between items-center"><span>${tx.description}</span><span class="font-bold ${tx.type === 'income' ? 'text-green-400' : 'text-red-400'}">${tx.type === 'income' ? '+' : '-'}$${tx.amount.toFixed(2)}</span></div><div class="text-xs opacity-60 text-right">${tx.date}</div></div>`).join(''); }

function renderStore() {
    const unpurchasedItems = state.storeItems.filter(item => !item.purchased);
    DOM.storeCarousel.innerHTML = unpurchasedItems.length === 0 ? '<p class="text-center opacity-50 w-full">¡Has comprado todo lo disponible!</p>' : unpurchasedItems.map((item, index) => {
        const originalIndex = state.storeItems.findIndex(i => i.id === item.id);
        const imageUrl = item.imageData || `https://placehold.co/300x200/161b22/c9d1d9?text=${item.name.replace(/\s/g,'+')}`;
        return `<div class="carousel-slide item-card-minimal"><div class="relative w-full mb-2"><img src="${imageUrl}" alt="${item.name}" class="item-image locked"><div class="lock-overlay"><i data-lucide="lock" class="w-16 h-16"></i></div></div><h4 class="item-name text-text-accent-color text-center truncate">${item.name}</h4><p class="item-price text-green-400 text-center mb-2">$${item.price.toFixed(2)}</p><button class="pixel-button yellow w-full" onclick="buyStoreItem(${originalIndex})">Comprar</button></div>`;
    }).join('');
    // Resetea el scroll del carrusel cada vez que se renderiza para mostrar el primer elemento
    DOM.storeCarousel.scrollLeft = 0;
    lucide.createIcons(); 
}

function renderInventory() {
    const purchasedItems = state.storeItems.filter(item => item.purchased);
    DOM.inventoryList.innerHTML = purchasedItems.length === 0 ? '<p class="text-center opacity-50 col-span-full">Aún no tienes objetos.</p>' : purchasedItems.map(item => {
        const imageUrl = item.imageData || `https://placehold.co/300x200/161b22/c9d1d9?text=${item.name.replace(/\s/g,'+')}`;
        return `<div class="item-card-minimal"><img src="${imageUrl}" alt="${item.name}" class="item-image mb-2"><h4 class="item-name text-text-accent-color text-center truncate">${item.name}</h4></div>`;
    }).join('');
}

function renderWardrobe() {
    DOM.wardrobeInventory.innerHTML = state.wardrobe.clothes.length === 0 ? '<p class="text-center opacity-50 col-span-full">Armario vacío.</p>' : state.wardrobe.clothes.map(item => `<div class="relative group"><img src="${item.imageUrl}" alt="${item.name}" class="w-full h-24 object-contain border-2 border-gray-400 bg-transparent" onerror="this.src='https://placehold.co/100x100/161b22/c9d1d9?text=Error'"><div class="absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"><button onclick="removeWardrobeItem('${item.id}')" class="text-red-500"><i data-lucide="trash-2"></i></button></div></div>`).join('');
    DOM.weeklyPlanner.innerHTML = Object.keys(state.wardrobe.outfits).map(day => {
        const outfitHtml = state.wardrobe.outfits[day].map(id => { const item = state.wardrobe.clothes.find(c => c.id === id); return item ? `<img src="${item.imageUrl}" class="w-8 h-8 inline-block object-contain border-2 border-gray-400 bg-transparent" title="${item.name}">` : '' }).join('');
        return `<div class="border-2 border-dashed border-gray-600 p-2"><div class="flex justify-between items-center mb-2"><h4 class="text-md">${day}</h4><button class="pixel-button !p-1 text-xs" onclick="openOutfitPlanner('${day}')">Plan</button></div><div class="flex flex-wrap gap-1 min-h-[40px]">${outfitHtml || '<p class="text-xs opacity-50">Sin planificar</p>'}</div></div>`;
    }).join('');
}

function addMission() { const i = document.getElementById('new-mission-input'); const t = i.value.trim(); if(t){ state.missions.push({text: t, completed: false}); i.value = ''; saveState(); render(); } }
function toggleMission(i) { state.missions[i].completed = !state.missions[i].completed; saveState(); render(); }

function addTransaction(type) { const aEl = document.getElementById(`${type}-amount`); const dEl = document.getElementById(type==='income'?'income-source':'expense-description'); const a = parseFloat(aEl.value); const d = dEl.value.trim(); if(!a||a<=0||!d) return; if(type==='expense'&&a>state.balance) return; state.balance += type==='income'?a:-a; state.transactions.push({type,amount:a,description:d,date:new Date().toLocaleString('es-MX',{dateStyle:'short',timeStyle:'short'})}); aEl.value='';dEl.value=''; closeModal(`${type}-modal`); saveState(); render(); }

function addStoreItem() {
    const nameEl = document.getElementById('item-name'), priceEl = document.getElementById('item-price'), imageEl = document.getElementById('item-image-upload');
    const name = nameEl.value.trim(), price = parseFloat(priceEl.value), file = imageEl.files[0];
    if (!name || !price || price <= 0) return alert('Completa nombre y precio.');
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            state.storeItems.push({ id: `item_${Date.now()}`, name, price, imageData: e.target.result, purchased: false });
            resetModalAndRender();
        }
        reader.readAsDataURL(file);
    } else {
        // En caso de no subir imagen, usa un placeholder con fondo transparente
        state.storeItems.push({ id: `item_${Date.now()}`, name, price, imageData: `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='transparent'/%3E%3Ctext x='50%25' y='50%25' font-family='Press Start 2P, cursive' font-size='20' fill='%23c9d1d9' text-anchor='middle' alignment-baseline='middle'%3E${encodeURIComponent(name.replace(/\s/g,'+'))}%3C/text%3E%3C/svg%3E`, purchased: false });
        resetModalAndRender();
    }
    function resetModalAndRender() {
        nameEl.value = ''; priceEl.value = ''; imageEl.value = '';
        closeModal('new-item-modal'); saveState(); render();
    }
}

function buyStoreItem(index) { const item = state.storeItems[index]; if(item.purchased || state.balance < item.price) return; state.balance -= item.price; item.purchased = true; saveState(); render(); }
function addWardrobeItem() { const nEl=document.getElementById('clothing-name'), uEl=document.getElementById('clothing-url'), n=nEl.value.trim(), u=uEl.value.trim(); if(!n||!u) return; state.wardrobe.clothes.push({id:`cloth_${Date.now()}`,name:n,imageUrl:u}); nEl.value='';uEl.value=''; closeModal('add-clothing-modal'); saveState(); render(); }
function removeWardrobeItem(id) { state.wardrobe.clothes=state.wardrobe.clothes.filter(i=>i.id!==id); Object.keys(state.wardrobe.outfits).forEach(d=>{ state.wardrobe.outfits[d]=state.wardrobe.outfits[d].filter(i=>i!==id) }); saveState(); render(); }

function openOutfitPlanner(day) { window.planningDay=day; document.getElementById('plan-outfit-title').textContent=`Planificar Outfit para ${day}`; const inv=document.getElementById('plan-outfit-inventory'); const cBtn=`<button class="pixel-button gray !p-2 col-span-full" onclick="clearOutfit('${day}')">Limpiar</button>`; const iHtml=state.wardrobe.clothes.map(i=>{const s=state.wardrobe.outfits[day].includes(i.id);return`<div class="cursor-pointer" onclick="toggleOutfitItem('${day}','${i.id}')"><img src="${i.imageUrl}" class="w-full h-24 object-contain border-4 ${s?'border-accent-color':'border-gray-400'}" style="${s?'--tw-border-opacity:1;border-color:rgb(56 139 253/var(--tw-border-opacity));':''}"></div>`}).join(''); inv.innerHTML=cBtn+iHtml; openModal('plan-outfit-modal');}
function toggleOutfitItem(day, id) { const o=state.wardrobe.outfits[day], i=o.indexOf(id); if(i>-1)o.splice(i,1); else o.push(id); saveState(); openOutfitPlanner(day); }
function clearOutfit(day) { state.wardrobe.outfits[day]=[]; saveState(); render(); closeModal('plan-outfit-modal'); }
function slideStore(dir) { const c=DOM.storeCarousel; const slideWidth = c.querySelector('.carousel-slide') ? c.querySelector('.carousel-slide').offsetWidth + 20 : c.clientWidth; // Ancho del slide + margen
    c.scrollBy({ left: slideWidth * dir, behavior: 'smooth' });
}


function showTab(tabId) { document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active')); document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active')); document.getElementById(`${tabId}-tab`).classList.add('active'); document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active'); }
function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
function closeModal(id) { document.getElementById(id).classList.add('hidden'); }

document.addEventListener('DOMContentLoaded', () => { loadState(); render(); showTab('misiones'); });
</script>
</body>
</html>
